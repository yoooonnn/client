{"ast":null,"code":"'use strict';\n\nvar BN = require('bn.js');\nvar utils = require('../utils');\nvar assert = utils.assert;\nvar cachedProperty = utils.cachedProperty;\nvar parseBytes = utils.parseBytes;\n\n/**\n* @param {EDDSA} eddsa - eddsa instance\n* @param {Array<Bytes>|Object} sig -\n* @param {Array<Bytes>|Point} [sig.R] - R point as Point or bytes\n* @param {Array<Bytes>|bn} [sig.S] - S scalar as bn or bytes\n* @param {Array<Bytes>} [sig.Rencoded] - R point encoded\n* @param {Array<Bytes>} [sig.Sencoded] - S scalar encoded\n*/\nfunction Signature(eddsa, sig) {\n  this.eddsa = eddsa;\n  if (typeof sig !== 'object') sig = parseBytes(sig);\n  if (Array.isArray(sig)) {\n    assert(sig.length === eddsa.encodingLength * 2, 'Signature has invalid size');\n    sig = {\n      R: sig.slice(0, eddsa.encodingLength),\n      S: sig.slice(eddsa.encodingLength)\n    };\n  }\n  assert(sig.R && sig.S, 'Signature without R or S');\n  if (eddsa.isPoint(sig.R)) this._R = sig.R;\n  if (sig.S instanceof BN) this._S = sig.S;\n  this._Rencoded = Array.isArray(sig.R) ? sig.R : sig.Rencoded;\n  this._Sencoded = Array.isArray(sig.S) ? sig.S : sig.Sencoded;\n}\ncachedProperty(Signature, 'S', function S() {\n  return this.eddsa.decodeInt(this.Sencoded());\n});\ncachedProperty(Signature, 'R', function R() {\n  return this.eddsa.decodePoint(this.Rencoded());\n});\ncachedProperty(Signature, 'Rencoded', function Rencoded() {\n  return this.eddsa.encodePoint(this.R());\n});\ncachedProperty(Signature, 'Sencoded', function Sencoded() {\n  return this.eddsa.encodeInt(this.S());\n});\nSignature.prototype.toBytes = function toBytes() {\n  return this.Rencoded().concat(this.Sencoded());\n};\nSignature.prototype.toHex = function toHex() {\n  return utils.encode(this.toBytes(), 'hex').toUpperCase();\n};\nmodule.exports = Signature;","map":{"version":3,"names":["BN","require","utils","assert","cachedProperty","parseBytes","Signature","eddsa","sig","Array","isArray","length","encodingLength","R","slice","S","isPoint","_R","_S","_Rencoded","Rencoded","_Sencoded","Sencoded","decodeInt","decodePoint","encodePoint","encodeInt","prototype","toBytes","concat","toHex","encode","toUpperCase","module","exports"],"sources":["/Users/yoon/Documents/소프트웨어공학/client/authentication/node_modules/elliptic/lib/elliptic/eddsa/signature.js"],"sourcesContent":["'use strict';\n\nvar BN = require('bn.js');\nvar utils = require('../utils');\nvar assert = utils.assert;\nvar cachedProperty = utils.cachedProperty;\nvar parseBytes = utils.parseBytes;\n\n/**\n* @param {EDDSA} eddsa - eddsa instance\n* @param {Array<Bytes>|Object} sig -\n* @param {Array<Bytes>|Point} [sig.R] - R point as Point or bytes\n* @param {Array<Bytes>|bn} [sig.S] - S scalar as bn or bytes\n* @param {Array<Bytes>} [sig.Rencoded] - R point encoded\n* @param {Array<Bytes>} [sig.Sencoded] - S scalar encoded\n*/\nfunction Signature(eddsa, sig) {\n  this.eddsa = eddsa;\n\n  if (typeof sig !== 'object')\n    sig = parseBytes(sig);\n\n  if (Array.isArray(sig)) {\n    assert(sig.length === eddsa.encodingLength * 2, 'Signature has invalid size');\n    sig = {\n      R: sig.slice(0, eddsa.encodingLength),\n      S: sig.slice(eddsa.encodingLength),\n    };\n  }\n\n  assert(sig.R && sig.S, 'Signature without R or S');\n\n  if (eddsa.isPoint(sig.R))\n    this._R = sig.R;\n  if (sig.S instanceof BN)\n    this._S = sig.S;\n\n  this._Rencoded = Array.isArray(sig.R) ? sig.R : sig.Rencoded;\n  this._Sencoded = Array.isArray(sig.S) ? sig.S : sig.Sencoded;\n}\n\ncachedProperty(Signature, 'S', function S() {\n  return this.eddsa.decodeInt(this.Sencoded());\n});\n\ncachedProperty(Signature, 'R', function R() {\n  return this.eddsa.decodePoint(this.Rencoded());\n});\n\ncachedProperty(Signature, 'Rencoded', function Rencoded() {\n  return this.eddsa.encodePoint(this.R());\n});\n\ncachedProperty(Signature, 'Sencoded', function Sencoded() {\n  return this.eddsa.encodeInt(this.S());\n});\n\nSignature.prototype.toBytes = function toBytes() {\n  return this.Rencoded().concat(this.Sencoded());\n};\n\nSignature.prototype.toHex = function toHex() {\n  return utils.encode(this.toBytes(), 'hex').toUpperCase();\n};\n\nmodule.exports = Signature;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}